\documentclass[letterpaper,12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}
\usepackage{graphicx}
\graphicspath{{images/}}
\usepackage{float}
\usepackage{wrapfig}

\begin{document}

\begin{center}
      Алгоритм определения правильности отрезка.
\end{center}

Входные данные: отрезок $s$, грань РСДС $f$, упорядоченное по 
полярному углу множество точек $P_u$, индексы $i, j$ краевых точек $s$
в $P_u$.

Выходные данные: <<да>>, если $s$ правильный. <<нет>>, если $s$ 
неправильный.

Алгоритм: если точки рядом, то ответ <<нет>>. Иначе
выбираем произвольную внутреннюю точку $f$, находим ориентированную
площадь треугольника $q p_i p_j$ (Не умаляя общности, считаем что
точка $p_i$ раньше $p_j$ в упорядоченном списке), если она положительна,
то ответ <<да>>, иначе ответ <<нет>>.

\hspace{4em}

\begin{center}
      Теорема. Статус не зависит от выбора точки внутри $f$
\end{center}
Доказательство.
Статус - упорядоченные по полярному углу концы отрезков, правильность каждого 
отрезка.
\begin{enumerate}
      \item Упорядочение не поменяется.
            Предположим противное, пусть в $f$ существует две точки $A_1, A_2$, 
            для которых порядок в упорядоченном массиве отличается. Не умаляя 
            общности, будем считать, что порядок отличается только для двух
            точек $p_1, p_2$. Тогда в силу непрерывности значения полярного 
            угла каждой точки  $\exists t \in (0, 1) : A(t) = (1 - t)A_1 + tA_2$ 
            такая, что точки $p_1, p_2$ имеют одинаковый полярный угол 
            относительно $ A(t) $. Получили противоречие. 
      \item Правильность отрезков.
            Заметим, что правильность отрезка может поменяться, только в двух 
            случаях:
            \begin{itemize}
                  \item Точки поменялись местами в упорядоченном списке. Что 
                        невозможно по первому пункту.
                  \item Поменялся поворот угла, что возможно только при 
                        перешагивании ребра, построенного на точках одного 
                        отрезка.
            \end{itemize}
\end{enumerate}

\hspace{4em}

\begin{center}
      Теорема. В процессе перешагивания ребра статус меняется не сильно.
\end{center}
Доказательство.
Статус - упорядоченные по полярному углу концы отрезков, 
правильность каждого отрезка. Обозначим ребро за $e$, грани, которые оно 
разделяет за $f_1$ и $f_2$.
\begin{enumerate}
      \item Упорядочение поменяется только для не более чем двух точек.
 
            Предположим противное, это означает, что
            $\forall \varepsilon > 0 : \exists A_1 \in f_1, A_2 \in f_2 : 
            \exists A_0 \in e  :  |A_0 - A_1|  < \varepsilon, 
            |A_0 - A_2|  < \varepsilon$,
            кроме того, порядок точек в статусе в $A_1$, $A_2$ различен 
            для $n > 2$ точек. В силу бесконечной малости отрезка $A_1 A_2$,
            все $n$ точек должны иметь одинаковые полярные углы в точке,
            лежащей на $e$, а значит на прямой, порожденной $e$ лежит $>2$
            точек, что противоречит условию МТОП.
      \item Правильность отрезков.

            При перешагивании ребра $e$ 
            в упорядоченном массиве для каких-то точек поменялись соседи.
            По первому пункту таких точек ровно $4$.
            Также для максимум двух отрезков (на концах которых построено ребро $e$)
            может поменяться правильность.
            Тогда как минимум для $n-4$ отрезков их концы не поменяют соседей,
            а значит, если отрезок не был правильным, то он правильным не станет.
            Если отрезок был правильным, то его правильность может измениться,
            только если изменится поворот.
            Не сложно заметить, что поворот отрезка может поменяться,
            только когда этот отрезок содержит $e$.
            Но так как у концов этого отрезка соседи не поменялись,
            то $e$ построен не на концах этого отрезка.
            Значит такой отрезок останется правильным.
\end{enumerate}
\end{document}
